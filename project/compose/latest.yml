proxy:
  image: pumgrana-proxy:latest
  restart: always
  environment:
    CONF_FILE: pumgrana.conf
  ports:
    - "80:80"
  links:
    - api-authentication
    - api-user
    - dashboard

dashboard:
  image: pumgrana-dashboard:latest
  restart: always

api-user:
  image: pumgrana-api-user:latest
  restart: always
  links:
    - api-authentication
    - elasticsearch
    - postgres

api-authentication:
  image: pumgrana-api-authentication:latest
  restart: always
  links:
    - postgres

api-plugin:
  image: pumgrana-api-plugin:latest
  restart: always
  ports:
    - "9000:9000"
  links:
    - api-authentication
    - elasticsearch
    - postgres

elasticsearch:
  image: pumgrana-elasticsearch:latest
  restart: always
  environment:
    ES_HEAP_SIZE: 2g
  volumes:
    - /srv/data/elasticsearch/test:/usr/share/elasticsearch/data
  command: "./bin/elasticsearch -Des.nodes.discovery=false"

postgres:
  image: pumgrana-postgres:latest
  restart: always
  volumes:
    - /srv/data/pgsql/test:/var/lib/postgresql/data
